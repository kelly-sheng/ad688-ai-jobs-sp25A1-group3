<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kelly, Sabrina, Makenzie">

<title>Data Analysis â€“ AI Jobs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5b4ad623e5705c0698d39aec6f10cf02.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">AI Jobs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./research_introduction.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./data_analysis.html" aria-current="page"> 
<span class="menu-text">Data Analysis</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#loading-libraries-and-data" id="toc-loading-libraries-and-data" class="nav-link active" data-scroll-target="#loading-libraries-and-data"><span class="header-section-number">1</span> Loading Libraries and Data</a></li>
  <li><a href="#cleaning-data" id="toc-cleaning-data" class="nav-link" data-scroll-target="#cleaning-data"><span class="header-section-number">2</span> Cleaning Data</a></li>
  <li><a href="#plot-setup-for-ai-vs-non-ai-job-posting-count" id="toc-plot-setup-for-ai-vs-non-ai-job-posting-count" class="nav-link" data-scroll-target="#plot-setup-for-ai-vs-non-ai-job-posting-count"><span class="header-section-number">3</span> Plot setup for AI vs Non-AI job posting count</a></li>
  <li><a href="#job-postings-for-ai-vs-non-ai-jobs" id="toc-job-postings-for-ai-vs-non-ai-jobs" class="nav-link" data-scroll-target="#job-postings-for-ai-vs-non-ai-jobs"><span class="header-section-number">4</span> Job Postings for AI vs Non-AI Jobs</a></li>
  <li><a href="#prep-for-monthly-ai-counts" id="toc-prep-for-monthly-ai-counts" class="nav-link" data-scroll-target="#prep-for-monthly-ai-counts"><span class="header-section-number">5</span> Prep for monthly AI counts</a></li>
  <li><a href="#ai-driven-job-growth-by-industry" id="toc-ai-driven-job-growth-by-industry" class="nav-link" data-scroll-target="#ai-driven-job-growth-by-industry"><span class="header-section-number">6</span> AI-Driven Job Growth by Industry</a></li>
  <li><a href="#non-ai-job-posting-growth-by-industry-setup" id="toc-non-ai-job-posting-growth-by-industry-setup" class="nav-link" data-scroll-target="#non-ai-job-posting-growth-by-industry-setup"><span class="header-section-number">7</span> Non-AI Job Posting Growth by Industry setup</a></li>
  <li><a href="#non-ai-job-posting-growth-by-industry" id="toc-non-ai-job-posting-growth-by-industry" class="nav-link" data-scroll-target="#non-ai-job-posting-growth-by-industry"><span class="header-section-number">8</span> Non-AI Job Posting Growth by Industry</a></li>
  <li><a href="#ai-powered-roles-vs-non-ai-roles-salary-prep" id="toc-ai-powered-roles-vs-non-ai-roles-salary-prep" class="nav-link" data-scroll-target="#ai-powered-roles-vs-non-ai-roles-salary-prep"><span class="header-section-number">9</span> AI-powered roles vs non-ai roles salary prep</a></li>
  <li><a href="#ai-powered-roles-salaries-vs.-non-ai-roles-salaries" id="toc-ai-powered-roles-salaries-vs.-non-ai-roles-salaries" class="nav-link" data-scroll-target="#ai-powered-roles-salaries-vs.-non-ai-roles-salaries"><span class="header-section-number">10</span> AI-powered Roles Salaries vs.&nbsp;Non-AI Roles Salaries</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Analysis</h1>
<p class="subtitle lead">Comprehensive Data Cleaning &amp; Exploratory Analysis of Job Market Trends</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Kelly, Sabrina, Makenzie </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Boston University
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="loading-libraries-and-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Loading Libraries and Data</h1>
<div id="0ab234aa" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.sql <span class="im">import</span> SparkSession</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>raw_df <span class="op">=</span> pd.read_csv(<span class="st">"data/lightcast_job_postings.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>raw_df.columns.tolist()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/mw/hvx6c2015337qp08y2pvrxm80000gn/T/ipykernel_36620/4224945869.py:5: DtypeWarning: Columns (19,30) have mixed types. Specify dtype option on import or set low_memory=False.
  raw_df = pd.read_csv("data/lightcast_job_postings.csv")</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>['ID',
 'LAST_UPDATED_DATE',
 'LAST_UPDATED_TIMESTAMP',
 'DUPLICATES',
 'POSTED',
 'EXPIRED',
 'DURATION',
 'SOURCE_TYPES',
 'SOURCES',
 'URL',
 'ACTIVE_URLS',
 'ACTIVE_SOURCES_INFO',
 'TITLE_RAW',
 'BODY',
 'MODELED_EXPIRED',
 'MODELED_DURATION',
 'COMPANY',
 'COMPANY_NAME',
 'COMPANY_RAW',
 'COMPANY_IS_STAFFING',
 'EDUCATION_LEVELS',
 'EDUCATION_LEVELS_NAME',
 'MIN_EDULEVELS',
 'MIN_EDULEVELS_NAME',
 'MAX_EDULEVELS',
 'MAX_EDULEVELS_NAME',
 'EMPLOYMENT_TYPE',
 'EMPLOYMENT_TYPE_NAME',
 'MIN_YEARS_EXPERIENCE',
 'MAX_YEARS_EXPERIENCE',
 'IS_INTERNSHIP',
 'SALARY',
 'REMOTE_TYPE',
 'REMOTE_TYPE_NAME',
 'ORIGINAL_PAY_PERIOD',
 'SALARY_TO',
 'SALARY_FROM',
 'LOCATION',
 'CITY',
 'CITY_NAME',
 'COUNTY',
 'COUNTY_NAME',
 'MSA',
 'MSA_NAME',
 'STATE',
 'STATE_NAME',
 'COUNTY_OUTGOING',
 'COUNTY_NAME_OUTGOING',
 'COUNTY_INCOMING',
 'COUNTY_NAME_INCOMING',
 'MSA_OUTGOING',
 'MSA_NAME_OUTGOING',
 'MSA_INCOMING',
 'MSA_NAME_INCOMING',
 'NAICS2',
 'NAICS2_NAME',
 'NAICS3',
 'NAICS3_NAME',
 'NAICS4',
 'NAICS4_NAME',
 'NAICS5',
 'NAICS5_NAME',
 'NAICS6',
 'NAICS6_NAME',
 'TITLE',
 'TITLE_NAME',
 'TITLE_CLEAN',
 'SKILLS',
 'SKILLS_NAME',
 'SPECIALIZED_SKILLS',
 'SPECIALIZED_SKILLS_NAME',
 'CERTIFICATIONS',
 'CERTIFICATIONS_NAME',
 'COMMON_SKILLS',
 'COMMON_SKILLS_NAME',
 'SOFTWARE_SKILLS',
 'SOFTWARE_SKILLS_NAME',
 'ONET',
 'ONET_NAME',
 'ONET_2019',
 'ONET_2019_NAME',
 'CIP6',
 'CIP6_NAME',
 'CIP4',
 'CIP4_NAME',
 'CIP2',
 'CIP2_NAME',
 'SOC_2021_2',
 'SOC_2021_2_NAME',
 'SOC_2021_3',
 'SOC_2021_3_NAME',
 'SOC_2021_4',
 'SOC_2021_4_NAME',
 'SOC_2021_5',
 'SOC_2021_5_NAME',
 'LOT_CAREER_AREA',
 'LOT_CAREER_AREA_NAME',
 'LOT_OCCUPATION',
 'LOT_OCCUPATION_NAME',
 'LOT_SPECIALIZED_OCCUPATION',
 'LOT_SPECIALIZED_OCCUPATION_NAME',
 'LOT_OCCUPATION_GROUP',
 'LOT_OCCUPATION_GROUP_NAME',
 'LOT_V6_SPECIALIZED_OCCUPATION',
 'LOT_V6_SPECIALIZED_OCCUPATION_NAME',
 'LOT_V6_OCCUPATION',
 'LOT_V6_OCCUPATION_NAME',
 'LOT_V6_OCCUPATION_GROUP',
 'LOT_V6_OCCUPATION_GROUP_NAME',
 'LOT_V6_CAREER_AREA',
 'LOT_V6_CAREER_AREA_NAME',
 'SOC_2',
 'SOC_2_NAME',
 'SOC_3',
 'SOC_3_NAME',
 'SOC_4',
 'SOC_4_NAME',
 'SOC_5',
 'SOC_5_NAME',
 'LIGHTCAST_SECTORS',
 'LIGHTCAST_SECTORS_NAME',
 'NAICS_2022_2',
 'NAICS_2022_2_NAME',
 'NAICS_2022_3',
 'NAICS_2022_3_NAME',
 'NAICS_2022_4',
 'NAICS_2022_4_NAME',
 'NAICS_2022_5',
 'NAICS_2022_5_NAME',
 'NAICS_2022_6',
 'NAICS_2022_6_NAME']</code></pre>
</div>
</div>
</section>
<section id="cleaning-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Cleaning Data</h1>
<div id="c2db2d7e" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>columns_to_drop <span class="op">=</span> [</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ID"</span>, <span class="st">"URL"</span>, <span class="st">"ACTIVE_URLS"</span>, <span class="st">"DUPLICATES"</span>, <span class="st">"LAST_UPDATED_TIMESTAMP"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NAICS2"</span>, <span class="st">"NAICS3"</span>, <span class="st">"NAICS4"</span>, <span class="st">"NAICS5"</span>, <span class="st">"NAICS6"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SOC_2"</span>, <span class="st">"SOC_3"</span>, <span class="st">"SOC_5"</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>raw_df.drop(columns<span class="op">=</span>columns_to_drop, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill missing values</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>raw_df[<span class="st">"SALARY"</span>].fillna(raw_df[<span class="st">"SALARY"</span>].median(), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>raw_df[<span class="st">"NAICS_2022_6"</span>].fillna(<span class="st">"Unknown"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop columns with &gt;50% missing values</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>raw_df.dropna(thresh<span class="op">=</span><span class="bu">len</span>(raw_df) <span class="op">*</span> <span class="fl">0.5</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>raw_df <span class="op">=</span> raw_df.drop_duplicates(subset<span class="op">=</span>[<span class="st">"TITLE"</span>, <span class="st">"COMPANY"</span>, <span class="st">"LOCATION"</span>, <span class="st">"POSTED"</span>], keep<span class="op">=</span><span class="st">"first"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>raw_df.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/mw/hvx6c2015337qp08y2pvrxm80000gn/T/ipykernel_36620/2034363739.py:9: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  raw_df["SALARY"].fillna(raw_df["SALARY"].median(), inplace=True)
/var/folders/mw/hvx6c2015337qp08y2pvrxm80000gn/T/ipykernel_36620/2034363739.py:10: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  raw_df["NAICS_2022_6"].fillna("Unknown", inplace=True)
/var/folders/mw/hvx6c2015337qp08y2pvrxm80000gn/T/ipykernel_36620/2034363739.py:10: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value 'Unknown' has dtype incompatible with float64, please explicitly cast to a compatible dtype first.
  raw_df["NAICS_2022_6"].fillna("Unknown", inplace=True)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LAST_UPDATED_DATE</th>
<th data-quarto-table-cell-role="th">POSTED</th>
<th data-quarto-table-cell-role="th">EXPIRED</th>
<th data-quarto-table-cell-role="th">DURATION</th>
<th data-quarto-table-cell-role="th">SOURCE_TYPES</th>
<th data-quarto-table-cell-role="th">SOURCES</th>
<th data-quarto-table-cell-role="th">TITLE_RAW</th>
<th data-quarto-table-cell-role="th">BODY</th>
<th data-quarto-table-cell-role="th">MODELED_EXPIRED</th>
<th data-quarto-table-cell-role="th">MODELED_DURATION</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">NAICS_2022_2</th>
<th data-quarto-table-cell-role="th">NAICS_2022_2_NAME</th>
<th data-quarto-table-cell-role="th">NAICS_2022_3</th>
<th data-quarto-table-cell-role="th">NAICS_2022_3_NAME</th>
<th data-quarto-table-cell-role="th">NAICS_2022_4</th>
<th data-quarto-table-cell-role="th">NAICS_2022_4_NAME</th>
<th data-quarto-table-cell-role="th">NAICS_2022_5</th>
<th data-quarto-table-cell-role="th">NAICS_2022_5_NAME</th>
<th data-quarto-table-cell-role="th">NAICS_2022_6</th>
<th data-quarto-table-cell-role="th">NAICS_2022_6_NAME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>9/6/2024</td>
<td>6/2/2024</td>
<td>6/8/2024</td>
<td>6.0</td>
<td>[\n "Company"\n]</td>
<td>[\n "brassring.com"\n]</td>
<td>Enterprise Analyst (II-III)</td>
<td>31-May-2024\n\nEnterprise Analyst (II-III)\n\n...</td>
<td>6/8/2024</td>
<td>6.0</td>
<td>...</td>
<td>44.0</td>
<td>Retail Trade</td>
<td>441.0</td>
<td>Motor Vehicle and Parts Dealers</td>
<td>4413.0</td>
<td>Automotive Parts, Accessories, and Tire Retailers</td>
<td>44133.0</td>
<td>Automotive Parts and Accessories Retailers</td>
<td>441330.0</td>
<td>Automotive Parts and Accessories Retailers</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>8/2/2024</td>
<td>6/2/2024</td>
<td>8/1/2024</td>
<td>NaN</td>
<td>[\n "Job Board"\n]</td>
<td>[\n "maine.gov"\n]</td>
<td>Oracle Consultant - Reports (3592)</td>
<td>Oracle Consultant - Reports (3592)\n\nat SMX i...</td>
<td>8/1/2024</td>
<td>NaN</td>
<td>...</td>
<td>56.0</td>
<td>Administrative and Support and Waste Managemen...</td>
<td>561.0</td>
<td>Administrative and Support Services</td>
<td>5613.0</td>
<td>Employment Services</td>
<td>56132.0</td>
<td>Temporary Help Services</td>
<td>561320.0</td>
<td>Temporary Help Services</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>9/6/2024</td>
<td>6/2/2024</td>
<td>7/7/2024</td>
<td>35.0</td>
<td>[\n "Job Board"\n]</td>
<td>[\n "dejobs.org"\n]</td>
<td>Data Analyst</td>
<td>Taking care of people is at the heart of every...</td>
<td>6/10/2024</td>
<td>8.0</td>
<td>...</td>
<td>52.0</td>
<td>Finance and Insurance</td>
<td>524.0</td>
<td>Insurance Carriers and Related Activities</td>
<td>5242.0</td>
<td>Agencies, Brokerages, and Other Insurance Rela...</td>
<td>52429.0</td>
<td>Other Insurance Related Activities</td>
<td>524291.0</td>
<td>Claims Adjusting</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>9/6/2024</td>
<td>6/2/2024</td>
<td>7/20/2024</td>
<td>48.0</td>
<td>[\n "Job Board"\n]</td>
<td>[\n "disabledperson.com",\n "dejobs.org"\n]</td>
<td>Sr. Lead Data Mgmt. Analyst - SAS Product Owner</td>
<td>About this role:\n\nWells Fargo is looking for...</td>
<td>6/12/2024</td>
<td>10.0</td>
<td>...</td>
<td>52.0</td>
<td>Finance and Insurance</td>
<td>522.0</td>
<td>Credit Intermediation and Related Activities</td>
<td>5221.0</td>
<td>Depository Credit Intermediation</td>
<td>52211.0</td>
<td>Commercial Banking</td>
<td>522110.0</td>
<td>Commercial Banking</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>6/19/2024</td>
<td>6/2/2024</td>
<td>6/17/2024</td>
<td>15.0</td>
<td>[\n "FreeJobBoard"\n]</td>
<td>[\n "craigslist.org"\n]</td>
<td>Comisiones de $1000 - $3000 por semana... Comi...</td>
<td>Comisiones de $1000 - $3000 por semana... Comi...</td>
<td>6/17/2024</td>
<td>15.0</td>
<td>...</td>
<td>99.0</td>
<td>Unclassified Industry</td>
<td>999.0</td>
<td>Unclassified Industry</td>
<td>9999.0</td>
<td>Unclassified Industry</td>
<td>99999.0</td>
<td>Unclassified Industry</td>
<td>999999.0</td>
<td>Unclassified Industry</td>
</tr>
</tbody>
</table>

<p>5 rows Ã— 109 columns</p>
</div>
</div>
</div>
</section>
<section id="plot-setup-for-ai-vs-non-ai-job-posting-count" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Plot setup for AI vs Non-AI job posting count</h1>
<div id="956dc5a3" class="cell" data-df-print="default" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os, re</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Kellyâ€™s cleaned dataframe must exist</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="st">"raw_df"</span> <span class="kw">in</span> <span class="bu">globals</span>(), <span class="st">"raw_df must exist (Kellyâ€™s cleaned dataframe)."</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> raw_df.copy()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse date -&gt; month</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"POSTED"</span> <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Expected a POSTED column in raw_df."</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"POSTED_DT"</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">"POSTED"</span>], errors<span class="op">=</span><span class="st">"coerce"</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span>[<span class="st">"POSTED_DT"</span>])</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"month"</span>] <span class="op">=</span> df[<span class="st">"POSTED_DT"</span>].dt.to_period(<span class="st">"M"</span>).dt.to_timestamp()</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine likely text fields</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>candidate_text_cols <span class="op">=</span> [</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"TITLE"</span>,<span class="st">"TITLE_CLEAN"</span>,<span class="st">"TITLE_NAME"</span>,<span class="st">"BODY"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SKILLS"</span>,<span class="st">"SKILLS_NAME"</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SPECIALIZED_SKILLS"</span>,<span class="st">"SPECIALIZED_SKILLS_NAME"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SOFTWARE_SKILLS"</span>,<span class="st">"SOFTWARE_SKILLS_NAME"</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"COMMON_SKILLS"</span>,<span class="st">"COMMON_SKILLS_NAME"</span>,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CERTIFICATIONS_NAME"</span>,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>text_cols <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> candidate_text_cols <span class="cf">if</span> c <span class="kw">in</span> df.columns]</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> text_cols:</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    text_cols <span class="op">=</span> [<span class="st">"TITLE"</span>] <span class="cf">if</span> <span class="st">"TITLE"</span> <span class="kw">in</span> df.columns <span class="cf">else</span> []</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>text_series <span class="op">=</span> (</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    df[text_cols].astype(<span class="bu">str</span>).agg(<span class="st">" "</span>.join, axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">str</span>.lower()</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> text_cols <span class="cf">else</span> pd.Series([<span class="st">""</span>] <span class="op">*</span> <span class="bu">len</span>(df), index<span class="op">=</span>df.index)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co"># âœ… FIXED list (no cut-off strings)</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>ai_terms <span class="op">=</span> [</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artificial intelligence"</span>,<span class="st">"ai"</span>,<span class="st">"machine learning"</span>,<span class="st">"deep learning"</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"neural network"</span>,<span class="st">"nlp"</span>,<span class="st">"natural language"</span>,<span class="st">"computer vision"</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"reinforcement learning"</span>,<span class="st">"generative ai"</span>,<span class="st">"llm"</span>,<span class="st">"gpt"</span>,<span class="st">"chatgpt"</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"transformer"</span>,<span class="st">"bert"</span>,<span class="st">"prompt engineer"</span>,<span class="st">"prompt engineering"</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Word-boundary pattern so we don't match 'retail' for 'ai'</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>ai_pattern <span class="op">=</span> re.<span class="bu">compile</span>(</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"</span><span class="dv">\b</span>(?:<span class="vs">"</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">"|"</span>.join(re.escape(t) <span class="cf">for</span> t <span class="kw">in</span> ai_terms)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="vs">r"</span><span class="er">)</span><span class="dv">\b</span><span class="vs">"</span>,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    flags<span class="op">=</span>re.IGNORECASE,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"IS_AI"</span>] <span class="op">=</span> text_series.<span class="bu">str</span>.contains(ai_pattern, na<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly counts</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>monthly <span class="op">=</span> (</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    df.groupby([<span class="st">"month"</span>,<span class="st">"IS_AI"</span>])</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>      .size()</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>      .unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>      .rename(columns<span class="op">=</span>{<span class="va">True</span>: <span class="st">"AI"</span>, <span class="va">False</span>: <span class="st">"Non-AI"</span>})</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>      .sort_index()</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>monthly_plt <span class="op">=</span> monthly.copy()</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>monthly_plt.head(<span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">IS_AI</th>
<th data-quarto-table-cell-role="th">Non-AI</th>
<th data-quarto-table-cell-role="th">AI</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">2024-05-01</th>
<td>12460</td>
<td>1503</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2024-06-01</th>
<td>11462</td>
<td>2263</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2024-07-01</th>
<td>8463</td>
<td>3720</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2024-08-01</th>
<td>10619</td>
<td>3977</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2024-09-01</th>
<td>10148</td>
<td>4582</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="job-postings-for-ai-vs-non-ai-jobs" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Job Postings for AI vs Non-AI Jobs</h1>
<div id="cd5708b6" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.ticker <span class="im">import</span> FuncFormatter</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="st">"monthly_plt"</span> <span class="kw">in</span> <span class="bu">globals</span>(), <span class="st">"Run the setup chunk first."</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>os.makedirs(<span class="st">"output"</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>plt.plot(monthly_plt.index, monthly_plt[<span class="st">"AI"</span>],     marker<span class="op">=</span><span class="st">"o"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"AI jobs"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plt.plot(monthly_plt.index, monthly_plt[<span class="st">"Non-AI"</span>], marker<span class="op">=</span><span class="st">"o"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Non-AI jobs"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"AI vs Non-AI Job Postings Over Time (Monthly)"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Month"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of Job Postings"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>plt.gca().yaxis.set_major_formatter(FuncFormatter(<span class="kw">lambda</span> x, _: <span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(x)<span class="sc">:,}</span><span class="ss">"</span>))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">"output/ai_vs_nonai_over_time.png"</span>, dpi<span class="op">=</span><span class="dv">200</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/cell-5-output-1.png" width="1142" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="prep-for-monthly-ai-counts" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Prep for monthly AI counts</h1>
<div id="12af2213" class="cell" data-df-print="default" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os, re</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="st">"raw_df"</span> <span class="kw">in</span> <span class="bu">globals</span>(), <span class="st">"raw_df must exist."</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> raw_df.copy()</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Dates -&gt; month ----</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"POSTED_DT"</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">"POSTED"</span>], errors<span class="op">=</span><span class="st">"coerce"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span>[<span class="st">"POSTED_DT"</span>])</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"month"</span>] <span class="op">=</span> df[<span class="st">"POSTED_DT"</span>].dt.to_period(<span class="st">"M"</span>).dt.to_timestamp()</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- AI detector (reuse if already present) ----</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"IS_AI"</span> <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    ai_terms <span class="op">=</span> [</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial intelligence"</span>,<span class="st">"ai"</span>,<span class="st">"machine learning"</span>,<span class="st">"deep learning"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"neural network"</span>,<span class="st">"nlp"</span>,<span class="st">"natural language"</span>,<span class="st">"computer vision"</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"reinforcement learning"</span>,<span class="st">"generative ai"</span>,<span class="st">"llm"</span>,<span class="st">"gpt"</span>,<span class="st">"chatgpt"</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"transformer"</span>,<span class="st">"bert"</span>,<span class="st">"prompt engineer"</span>,<span class="st">"prompt engineering"</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    text_cols <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> [</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"TITLE"</span>,<span class="st">"TITLE_CLEAN"</span>,<span class="st">"BODY"</span>,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SKILLS"</span>,<span class="st">"SKILLS_NAME"</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SPECIALIZED_SKILLS"</span>,<span class="st">"SPECIALIZED_SKILLS_NAME"</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SOFTWARE_SKILLS"</span>,<span class="st">"SOFTWARE_SKILLS_NAME"</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"COMMON_SKILLS"</span>,<span class="st">"COMMON_SKILLS_NAME"</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"CERTIFICATIONS_NAME"</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    ] <span class="cf">if</span> c <span class="kw">in</span> df.columns]</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    combined <span class="op">=</span> (df[text_cols].astype(<span class="bu">str</span>).agg(<span class="st">" "</span>.join, axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">str</span>.lower()</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> text_cols <span class="cf">else</span> pd.Series([<span class="st">""</span>], index<span class="op">=</span>df.index))</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    pattern <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r"</span><span class="dv">\b</span>(?:<span class="vs">%s</span>)<span class="dv">\b</span><span class="vs">"</span> <span class="op">%</span> <span class="st">"|"</span>.join(re.escape(t) <span class="cf">for</span> t <span class="kw">in</span> ai_terms), re.I)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"IS_AI"</span>] <span class="op">=</span> combined.<span class="bu">str</span>.contains(pattern, na<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Pick the best available industry label ----</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>ind_candidates <span class="op">=</span> [</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NAICS_2022_6_NAME"</span>,<span class="st">"NAICS6_NAME"</span>,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NAICS_2022_4_NAME"</span>,<span class="st">"NAICS4_NAME"</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NAICS_2022_2_NAME"</span>,<span class="st">"NAICS2_NAME"</span>,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NAICS_2022_6"</span>,<span class="st">"NAICS6"</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>IND_COL <span class="op">=</span> <span class="bu">next</span>((c <span class="cf">for</span> c <span class="kw">in</span> ind_candidates <span class="cf">if</span> c <span class="kw">in</span> df.columns), <span class="va">None</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> IND_COL <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"No NAICS/industry name/code columns found."</span>)</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Monthly AI counts per industry ----</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>ai <span class="op">=</span> df[df[<span class="st">"IS_AI"</span>]].copy()</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>ai_monthly <span class="op">=</span> (</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    ai.groupby([IND_COL, <span class="st">"month"</span>])</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>      .size()</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>      .reset_index(name<span class="op">=</span><span class="st">"count"</span>)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Compute growth: (last 3-mo avg - first 3-mo avg) / first 3-mo avg ----</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> growth_row(g):</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> g.sort_values(<span class="st">"month"</span>)</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> <span class="bu">min</span>(<span class="dv">3</span>, <span class="bu">len</span>(g))</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>    first <span class="op">=</span> g[<span class="st">"count"</span>].iloc[:k].mean()</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>    last  <span class="op">=</span> g[<span class="st">"count"</span>].iloc[<span class="op">-</span>k:].mean()</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> g[<span class="st">"count"</span>].<span class="bu">sum</span>()</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> k <span class="op">&lt;</span> <span class="dv">2</span> <span class="kw">or</span> first <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.Series({<span class="st">"growth_pct"</span>: np.nan, <span class="st">"first_avg"</span>: first, <span class="st">"last_avg"</span>: last, <span class="st">"months"</span>: <span class="bu">len</span>(g), <span class="st">"total"</span>: total})</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.Series({<span class="st">"growth_pct"</span>: (last <span class="op">-</span> first) <span class="op">/</span> first <span class="op">*</span> <span class="fl">100.0</span>,</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"first_avg"</span>: first, <span class="st">"last_avg"</span>: last,</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"months"</span>: <span class="bu">len</span>(g), <span class="st">"total"</span>: total})</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>growth_df <span class="op">=</span> ai_monthly.groupby(IND_COL).<span class="bu">apply</span>(growth_row).reset_index()</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a><span class="co"># filter out tiny-volume industries to avoid wild % changes</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>MIN_TOTAL <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>growth_df <span class="op">=</span> growth_df[growth_df[<span class="st">"total"</span>] <span class="op">&gt;=</span> MIN_TOTAL].dropna(subset<span class="op">=</span>[<span class="st">"growth_pct"</span>])</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="co"># pick top movers (you can adjust top_n)</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>top_n <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>growth_top <span class="op">=</span> growth_df.sort_values(<span class="st">"growth_pct"</span>, ascending<span class="op">=</span><span class="va">False</span>).head(top_n)</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Save a copy if you want a table in the doc</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>growth_top_rounded <span class="op">=</span> growth_top.copy()</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>growth_top_rounded[<span class="st">"growth_pct"</span>] <span class="op">=</span> growth_top_rounded[<span class="st">"growth_pct"</span>].<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>growth_top_rounded.head(top_n)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/mw/hvx6c2015337qp08y2pvrxm80000gn/T/ipykernel_36620/1460438954.py:67: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  growth_df = ai_monthly.groupby(IND_COL).apply(growth_row).reset_index()</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NAICS_2022_6_NAME</th>
<th data-quarto-table-cell-role="th">growth_pct</th>
<th data-quarto-table-cell-role="th">first_avg</th>
<th data-quarto-table-cell-role="th">last_avg</th>
<th data-quarto-table-cell-role="th">months</th>
<th data-quarto-table-cell-role="th">total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">260</th>
<td>Offices of Other Holding Companies</td>
<td>372.7</td>
<td>3.666667</td>
<td>17.333333</td>
<td>5.0</td>
<td>56.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">300</th>
<td>Other Motor Vehicle Parts Manufacturing</td>
<td>330.8</td>
<td>4.333333</td>
<td>18.666667</td>
<td>5.0</td>
<td>68.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">358</th>
<td>Research and Development in the Physical, Engi...</td>
<td>176.2</td>
<td>14.000000</td>
<td>38.666667</td>
<td>5.0</td>
<td>133.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">137</th>
<td>Executive Search Services</td>
<td>160.0</td>
<td>6.666667</td>
<td>17.333333</td>
<td>5.0</td>
<td>59.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">80</th>
<td>Computer and Computer Peripheral Equipment and...</td>
<td>154.5</td>
<td>3.666667</td>
<td>9.333333</td>
<td>5.0</td>
<td>33.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">406</th>
<td>Temporary Help Services</td>
<td>148.8</td>
<td>42.333333</td>
<td>105.333333</td>
<td>5.0</td>
<td>352.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">189</th>
<td>Human Resources Consulting Services</td>
<td>125.6</td>
<td>13.000000</td>
<td>29.333333</td>
<td>5.0</td>
<td>96.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">296</th>
<td>Other Management Consulting Services</td>
<td>116.4</td>
<td>46.666667</td>
<td>101.000000</td>
<td>5.0</td>
<td>337.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">427</th>
<td>Wholesale Trade Agents and Brokers</td>
<td>109.5</td>
<td>7.000000</td>
<td>14.666667</td>
<td>5.0</td>
<td>52.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">325</th>
<td>Pharmaceutical Preparation Manufacturing</td>
<td>108.0</td>
<td>8.333333</td>
<td>17.333333</td>
<td>5.0</td>
<td>62.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">280</th>
<td>Other Computer Related Services</td>
<td>103.8</td>
<td>70.666667</td>
<td>144.000000</td>
<td>5.0</td>
<td>509.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">415</th>
<td>Unclassified Industry</td>
<td>101.8</td>
<td>280.666667</td>
<td>566.333333</td>
<td>5.0</td>
<td>2025.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="ai-driven-job-growth-by-industry" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> AI-Driven Job Growth by Industry</h1>
<div id="ebc1546c" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Short, readable labels + plot &amp; save (Option B) -------------------------</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os, re</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> textwrap <span class="im">import</span> shorten</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use your existing industry column if defined; otherwise default:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>IND_COL <span class="op">=</span> IND_COL <span class="cf">if</span> <span class="st">"IND_COL"</span> <span class="kw">in</span> <span class="bu">globals</span>() <span class="cf">else</span> <span class="st">"NAICS_2022_6_NAME"</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> short_label(s: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="bu">str</span>(s)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Common abbreviations to keep labels compact but clear</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">services</span><span class="op">?</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Svcs'</span>, s)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">manufacturing</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Mfg'</span>, s)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">preparation</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Prep'</span>, s)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">management</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Mgmt'</span>, s)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">computer</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Comp'</span>, s)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">equipment</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Equip'</span>, s)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">wholesale</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Whsl'</span>, s)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">agents</span><span class="op">?</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Agts'</span>, s)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">scientific</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Sci'</span>, s)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">engineering</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Eng'</span>, s)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">and</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'&amp;'</span>, s)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">other</span><span class="dv">\b\s</span><span class="op">*</span><span class="vs">'</span>, <span class="st">''</span>, s)  <span class="co"># drop leading "Other"</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Final safe trim</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> shorten(s.strip(), width<span class="op">=</span><span class="dv">32</span>, placeholder<span class="op">=</span><span class="st">'â€¦'</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>plot_df <span class="op">=</span> growth_top.copy()</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>plot_df[<span class="st">"label"</span>] <span class="op">=</span> plot_df[IND_COL].astype(<span class="bu">str</span>).<span class="bu">map</span>(short_label)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">11</span>, <span class="dv">7</span>))</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax.barh(plot_df[<span class="st">"label"</span>], plot_df[<span class="st">"growth_pct"</span>], color<span class="op">=</span><span class="st">"#2F6DB3"</span>, edgecolor<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>ax.invert_yaxis()  <span class="co"># biggest at top</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"AI Job Posting Growth by Industry (First vs Last Month)"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Growth (%)"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Industry"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">"x"</span>, alpha<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Value labels</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> b <span class="kw">in</span> bars:</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> b.get_width()</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    ax.text(</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>        w <span class="op">+</span> (<span class="dv">1</span> <span class="cf">if</span> w <span class="op">&gt;=</span> <span class="dv">0</span> <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>        b.get_y() <span class="op">+</span> b.get_height() <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>w<span class="sc">:.1f}</span><span class="ss">%"</span>,</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>        va<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>        ha<span class="op">=</span><span class="st">"left"</span> <span class="cf">if</span> w <span class="op">&gt;=</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">"right"</span>,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>        fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>os.makedirs(<span class="st">"output"</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">"output/ai_industry_growth_shortlabels.png"</span>, dpi<span class="op">=</span><span class="dv">200</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/cell-7-output-1.png" width="1048" height="663" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="non-ai-job-posting-growth-by-industry-setup" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Non-AI Job Posting Growth by Industry setup</h1>
<div id="dd171980" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os, re</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> textwrap <span class="im">import</span> shorten</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="st">"raw_df"</span> <span class="kw">in</span> <span class="bu">globals</span>(), <span class="st">"raw_df must exist (your cleaned dataframe)."</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> raw_df.copy()</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Pick an industry-name column that exists</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>IND_COL <span class="op">=</span> <span class="bu">next</span>((c <span class="cf">for</span> c <span class="kw">in</span> [</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NAICS_2022_6_NAME"</span>,<span class="st">"NAICS6_NAME"</span>,<span class="st">"NAICS_2022_4_NAME"</span>,<span class="st">"NAICS4_NAME"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NAICS_2022_2_NAME"</span>,<span class="st">"NAICS2_NAME"</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>] <span class="cf">if</span> c <span class="kw">in</span> df.columns), <span class="va">None</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> IND_COL, <span class="st">"No industry/NAICS name column found."</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>TITLE_COL <span class="op">=</span> <span class="st">"TITLE_CLEAN"</span> <span class="cf">if</span> <span class="st">"TITLE_CLEAN"</span> <span class="kw">in</span> df.columns <span class="cf">else</span> <span class="st">"TITLE"</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> TITLE_COL <span class="kw">in</span> df.columns, <span class="st">"Need a TITLE or TITLE_CLEAN column."</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Dates â†’ month</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"POSTED_DT"</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">"POSTED"</span>], errors<span class="op">=</span><span class="st">"coerce"</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span>[<span class="st">"POSTED_DT"</span>, IND_COL])</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"month"</span>] <span class="op">=</span> df[<span class="st">"POSTED_DT"</span>].dt.to_period(<span class="st">"M"</span>).dt.to_timestamp()</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect AI vs non-AI via title keywords</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>AI_TERMS <span class="op">=</span> [</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artificial intelligence"</span>, <span class="vs">r"</span><span class="dv">\b</span><span class="vs">AI</span><span class="dv">\b</span><span class="vs">"</span>, <span class="st">"machine learning"</span>, <span class="vs">r"</span><span class="dv">\b</span><span class="vs">ML</span><span class="dv">\b</span><span class="vs">"</span>,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"deep learning"</span>, <span class="vs">r"</span><span class="dv">\b</span><span class="vs">LLM</span><span class="dv">\b</span><span class="vs">"</span>, <span class="vs">r"</span><span class="dv">\b</span><span class="vs">NLP</span><span class="dv">\b</span><span class="vs">"</span>, <span class="st">"computer vision"</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"generative"</span>, <span class="st">"chatgpt"</span>, <span class="vs">r"gpt-</span><span class="dv">\d</span><span class="op">+</span><span class="vs">"</span>, <span class="st">"transformer"</span>, <span class="st">"bert"</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"prompt engineer"</span>, <span class="st">"reinforcement learning"</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>ai_pat <span class="op">=</span> re.<span class="bu">compile</span>(<span class="st">"|"</span>.join(AI_TERMS), flags<span class="op">=</span>re.IGNORECASE)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"is_ai"</span> <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"is_ai"</span>] <span class="op">=</span> df[TITLE_COL].astype(<span class="bu">str</span>).<span class="bu">str</span>.contains(ai_pat, na<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Use industries from your AI-growth visual if available; otherwise pick top 10 by AI postings last month</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"growth_top"</span> <span class="kw">in</span> <span class="bu">globals</span>():</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    target_inds <span class="op">=</span> [<span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> growth_top[IND_COL].dropna().tolist()]</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    last_m <span class="op">=</span> df[<span class="st">"month"</span>].<span class="bu">max</span>()</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    ai_last <span class="op">=</span> (df[df[<span class="st">"is_ai"</span>] <span class="op">&amp;</span> (df[<span class="st">"month"</span>] <span class="op">==</span> last_m)]</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>               .groupby(IND_COL).size().sort_values(ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">10</span>))</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    target_inds <span class="op">=</span> ai_last.index.astype(<span class="bu">str</span>).tolist()</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Build non-AI growth (% firstâ†’last month) for those industries</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>non_ai <span class="op">=</span> df[(<span class="op">~</span>df[<span class="st">"is_ai"</span>]) <span class="op">&amp;</span> (df[IND_COL].astype(<span class="bu">str</span>).isin(target_inds))].copy()</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>monthly <span class="op">=</span> (non_ai.groupby([IND_COL, <span class="st">"month"</span>]).size().reset_index(name<span class="op">=</span><span class="st">"count"</span>))</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>first_last <span class="op">=</span> (monthly.sort_values(<span class="st">"month"</span>)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>                     .groupby(IND_COL, as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>                     .agg(first<span class="op">=</span>(<span class="st">"count"</span>,<span class="st">"first"</span>), last<span class="op">=</span>(<span class="st">"count"</span>,<span class="st">"last"</span>)))</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>first_last <span class="op">=</span> first_last[first_last[<span class="st">"first"</span>] <span class="op">&gt;</span> <span class="dv">0</span>].copy()</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>first_last[<span class="st">"growth_pct"</span>] <span class="op">=</span> ((first_last[<span class="st">"last"</span>] <span class="op">-</span> first_last[<span class="st">"first"</span>])</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>                            <span class="op">/</span> first_last[<span class="st">"first"</span>]) <span class="op">*</span> <span class="fl">100.0</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>first_last <span class="op">=</span> first_last[first_last[IND_COL].astype(<span class="bu">str</span>).isin(target_inds)]</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> short_label(s: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="bu">str</span>(s)</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">services</span><span class="op">?</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Svcs'</span>, s)</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">manufacturing</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Mfg'</span>, s)</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">management</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Mgmt'</span>, s)</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">preparation</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Prep'</span>, s)</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">computer</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Comp'</span>, s)</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">equipment</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Equip'</span>, s)</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">wholesale</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Whsl'</span>, s)</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">and</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'&amp;'</span>, s)</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="dv">\s</span><span class="op">+</span><span class="vs">'</span>, <span class="st">' '</span>, s).strip()</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> shorten(s, width<span class="op">=</span><span class="dv">32</span>, placeholder<span class="op">=</span><span class="st">'â€¦'</span>)</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>non_ai_growth_plot_df <span class="op">=</span> (first_last</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>                         .sort_values(<span class="st">"growth_pct"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>                         .assign(label<span class="op">=</span><span class="kw">lambda</span> d: d[IND_COL].<span class="bu">map</span>(short_label)))</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>os.makedirs(<span class="st">"output"</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>non_ai_growth_plot_df.head(<span class="dv">10</span>)  <span class="co"># preview table</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NAICS_2022_6_NAME</th>
<th data-quarto-table-cell-role="th">first</th>
<th data-quarto-table-cell-role="th">last</th>
<th data-quarto-table-cell-role="th">growth_pct</th>
<th data-quarto-table-cell-role="th">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>Research and Development in the Physical, Engi...</td>
<td>45</td>
<td>114</td>
<td>153.333333</td>
<td>Research &amp; Development in theâ€¦</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">6</th>
<td>Other Motor Vehicle Parts Manufacturing</td>
<td>12</td>
<td>22</td>
<td>83.333333</td>
<td>Other Motor Vehicle Parts Mfg</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1</th>
<td>Executive Search Services</td>
<td>37</td>
<td>58</td>
<td>56.756757</td>
<td>Executive Search Svcs</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">0</th>
<td>Computer and Computer Peripheral Equipment and...</td>
<td>16</td>
<td>22</td>
<td>37.500000</td>
<td>Comp &amp; Comp Peripheral Equip &amp;â€¦</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>Other Management Consulting Services</td>
<td>162</td>
<td>195</td>
<td>20.370370</td>
<td>Other Mgmt Consulting Svcs</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Offices of Other Holding Companies</td>
<td>23</td>
<td>25</td>
<td>8.695652</td>
<td>Offices of Other Holdingâ€¦</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">9</th>
<td>Temporary Help Services</td>
<td>272</td>
<td>288</td>
<td>5.882353</td>
<td>Temporary Help Svcs</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">10</th>
<td>Unclassified Industry</td>
<td>2028</td>
<td>2025</td>
<td>-0.147929</td>
<td>Unclassified Industry</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Human Resources Consulting Services</td>
<td>32</td>
<td>31</td>
<td>-3.125000</td>
<td>Human Resources Consulting Svcs</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>Pharmaceutical Preparation Manufacturing</td>
<td>61</td>
<td>58</td>
<td>-4.918033</td>
<td>Pharmaceutical Prep Mfg</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="non-ai-job-posting-growth-by-industry" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Non-AI Job Posting Growth by Industry</h1>
<div id="75b203ff" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># If prep didn't run in this kernel, rebuild quickly</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"non_ai_growth_plot_df"</span> <span class="kw">not</span> <span class="kw">in</span> <span class="bu">globals</span>():</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Re-run a minimal rebuild using the same logic</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="st">"raw_df"</span> <span class="kw">in</span> <span class="bu">globals</span>(), <span class="st">"raw_df is required to rebuild plot data."</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># You can just execute the prep cell above; keeping this here for resilience:</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (We simply import the name if it exists; otherwise advise to run prep.)</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">AssertionError</span>(<span class="st">"Run the prep chunk first to create non_ai_growth_plot_df."</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>dfp <span class="op">=</span> non_ai_growth_plot_df.copy()</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> dfp.empty:</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"non_ai_growth_plot_df is emptyâ€”nothing to plot. "</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Check that selected industries have non-AI rows in the first/last month."</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    os.makedirs(<span class="st">"output"</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    colors <span class="op">=</span> dfp[<span class="st">"growth_pct"</span>].ge(<span class="dv">0</span>).<span class="bu">map</span>({<span class="va">True</span>: <span class="st">"#1f77b4"</span>, <span class="va">False</span>: <span class="st">"#d62728"</span>}).to_numpy()</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">11</span>, <span class="dv">7</span>))</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    bars <span class="op">=</span> ax.barh(dfp[<span class="st">"label"</span>], dfp[<span class="st">"growth_pct"</span>], color<span class="op">=</span>colors, edgecolor<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    ax.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"black"</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    ax.invert_yaxis()</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">"Non-AI Job Posting Growth by Industry (First â†’ Last Month)"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Growth (%)"</span>)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Industry"</span>)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    ax.grid(axis<span class="op">=</span><span class="st">"x"</span>, alpha<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> b, v <span class="kw">in</span> <span class="bu">zip</span>(bars, dfp[<span class="st">"growth_pct"</span>]):</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        ax.text(</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>            v <span class="op">+</span> (<span class="dv">1</span> <span class="cf">if</span> v <span class="op">&gt;=</span> <span class="dv">0</span> <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>            b.get_y() <span class="op">+</span> b.get_height() <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"</span><span class="sc">{</span>v<span class="sc">:.1f}</span><span class="ss">%"</span>,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">"left"</span> <span class="cf">if</span> v <span class="op">&gt;=</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">"right"</span>,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="st">"output/non_ai_growth_pct_in_ai_growth_industries_colored.png"</span>,</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>                dpi<span class="op">=</span><span class="dv">200</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/cell-9-output-1.png" width="1047" height="663" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ai-powered-roles-vs-non-ai-roles-salary-prep" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> AI-powered roles vs non-ai roles salary prep</h1>
<div id="e1f726da" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os, re</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="st">"raw_df"</span> <span class="kw">in</span> <span class="bu">globals</span>(), <span class="st">"raw_df (cleaned dataframe) must exist."</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> raw_df.copy()</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Pick columns robustly ---</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>TITLE_COL <span class="op">=</span> <span class="st">"TITLE_CLEAN"</span> <span class="cf">if</span> <span class="st">"TITLE_CLEAN"</span> <span class="kw">in</span> df.columns <span class="cf">else</span> <span class="st">"TITLE"</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> TITLE_COL <span class="kw">in</span> df.columns, <span class="st">"Need a TITLE or TITLE_CLEAN column."</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>IND_COL <span class="op">=</span> <span class="bu">next</span>((c <span class="cf">for</span> c <span class="kw">in</span> [</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NAICS_2022_6_NAME"</span>,<span class="st">"NAICS6_NAME"</span>,<span class="st">"NAICS_2022_4_NAME"</span>,<span class="st">"NAICS4_NAME"</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NAICS_2022_2_NAME"</span>,<span class="st">"NAICS2_NAME"</span>,<span class="st">"LIGHTCAST_SECTORS_NAME"</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>] <span class="cf">if</span> c <span class="kw">in</span> df.columns), <span class="va">None</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> IND_COL, <span class="st">"No industry/NAICS name column found."</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Salary: prefer SALARY; otherwise average of FROM/TO if present</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>sal <span class="op">=</span> pd.to_numeric(df.get(<span class="st">"SALARY"</span>, np.nan), errors<span class="op">=</span><span class="st">"coerce"</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> sal.isna().<span class="bu">all</span>() <span class="kw">and</span> {<span class="st">"SALARY_FROM"</span>,<span class="st">"SALARY_TO"</span>} <span class="op">&lt;=</span> <span class="bu">set</span>(df.columns):</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    s_from <span class="op">=</span> pd.to_numeric(df[<span class="st">"SALARY_FROM"</span>], errors<span class="op">=</span><span class="st">"coerce"</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    s_to   <span class="op">=</span> pd.to_numeric(df[<span class="st">"SALARY_TO"</span>],   errors<span class="op">=</span><span class="st">"coerce"</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    sal <span class="op">=</span> (s_from <span class="op">+</span> s_to) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"salary_num"</span>] <span class="op">=</span> pd.to_numeric(sal, errors<span class="op">=</span><span class="st">"coerce"</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co"># keep positive salaries only</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df[<span class="st">"salary_num"</span>] <span class="op">&gt;</span> <span class="dv">0</span>].copy()</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: cap extreme outliers so a few posts don't dominate the mean</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>q_low, q_hi <span class="op">=</span> df[<span class="st">"salary_num"</span>].quantile([<span class="fl">0.01</span>, <span class="fl">0.99</span>])</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"salary_num"</span>] <span class="op">=</span> df[<span class="st">"salary_num"</span>].clip(q_low, q_hi)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Tag AI vs non-AI using title keywords ---</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>AI_TERMS <span class="op">=</span> [</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artificial intelligence"</span>, <span class="vs">r"</span><span class="dv">\b</span><span class="vs">AI</span><span class="dv">\b</span><span class="vs">"</span>, <span class="st">"machine learning"</span>, <span class="vs">r"</span><span class="dv">\b</span><span class="vs">ML</span><span class="dv">\b</span><span class="vs">"</span>,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"deep learning"</span>, <span class="vs">r"</span><span class="dv">\b</span><span class="vs">LLM</span><span class="dv">\b</span><span class="vs">"</span>, <span class="vs">r"</span><span class="dv">\b</span><span class="vs">NLP</span><span class="dv">\b</span><span class="vs">"</span>, <span class="st">"computer vision"</span>,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"generative"</span>, <span class="st">"chatgpt"</span>, <span class="vs">r"gpt-</span><span class="dv">\d</span><span class="op">+</span><span class="vs">"</span>, <span class="st">"transformer"</span>, <span class="vs">r"</span><span class="dv">\b</span><span class="vs">bert</span><span class="dv">\b</span><span class="vs">"</span>,</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"prompt engineer"</span>, <span class="st">"reinforcement learning"</span>, <span class="st">"data scientist"</span>, <span class="st">"ai engineer"</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>ai_pat <span class="op">=</span> re.<span class="bu">compile</span>(<span class="st">"|"</span>.join(AI_TERMS), flags<span class="op">=</span>re.IGNORECASE)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"is_ai"</span>] <span class="op">=</span> df[TITLE_COL].astype(<span class="bu">str</span>).<span class="bu">str</span>.contains(ai_pat, na<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Find top industries by AI posting count (choose N)</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>ai_counts <span class="op">=</span> (df[df[<span class="st">"is_ai"</span>]]</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>             .groupby(IND_COL, dropna<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>             .size()</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>             .sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>             .head(N)</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>             .rename(<span class="st">"ai_posts"</span>)</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>             .reset_index())</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>top_inds <span class="op">=</span> ai_counts[IND_COL].astype(<span class="bu">str</span>).tolist()</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Compute average salary (AI vs non-AI) for those industries</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>subset <span class="op">=</span> df[df[IND_COL].astype(<span class="bu">str</span>).isin(top_inds)].copy()</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>grp <span class="op">=</span> subset.groupby([IND_COL, <span class="st">"is_ai"</span>])[<span class="st">"salary_num"</span>].agg([<span class="st">"mean"</span>, <span class="st">"count"</span>]).reset_index()</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>ai_part  <span class="op">=</span> grp[grp[<span class="st">"is_ai"</span>]].rename(columns<span class="op">=</span>{<span class="st">"mean"</span>:<span class="st">"avg_ai_salary"</span>, <span class="st">"count"</span>:<span class="st">"ai_postings"</span>})</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>non_part <span class="op">=</span> grp[<span class="op">~</span>grp[<span class="st">"is_ai"</span>]].rename(columns<span class="op">=</span>{<span class="st">"mean"</span>:<span class="st">"avg_nonai_salary"</span>, <span class="st">"count"</span>:<span class="st">"non_ai_postings"</span>})</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>ai_vs_trad_industry_salary <span class="op">=</span> (</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    ai_counts[[IND_COL, <span class="st">"ai_posts"</span>]]        <span class="co"># preserves AI-based ordering</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>    .merge(ai_part[[IND_COL, <span class="st">"avg_ai_salary"</span>, <span class="st">"ai_postings"</span>]], on<span class="op">=</span>IND_COL, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>    .merge(non_part[[IND_COL, <span class="st">"avg_nonai_salary"</span>, <span class="st">"non_ai_postings"</span>]], on<span class="op">=</span>IND_COL, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up &amp; preview</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>ai_vs_trad_industry_salary <span class="op">=</span> ai_vs_trad_industry_salary.fillna(<span class="dv">0</span>)</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>os.makedirs(<span class="st">"output"</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>ai_vs_trad_industry_salary.head(N)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NAICS_2022_6_NAME</th>
<th data-quarto-table-cell-role="th">ai_posts</th>
<th data-quarto-table-cell-role="th">avg_ai_salary</th>
<th data-quarto-table-cell-role="th">ai_postings</th>
<th data-quarto-table-cell-role="th">avg_nonai_salary</th>
<th data-quarto-table-cell-role="th">non_ai_postings</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>All Other Miscellaneous Food Manufacturing</td>
<td>124</td>
<td>125106.451613</td>
<td>124</td>
<td>108667.836735</td>
<td>49</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Computer Systems Design Services</td>
<td>81</td>
<td>120464.666667</td>
<td>81</td>
<td>123184.301252</td>
<td>4073</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Employment Placement Agencies</td>
<td>72</td>
<td>117815.555556</td>
<td>72</td>
<td>113490.867107</td>
<td>4244</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Direct Health and Medical Insurance Carriers</td>
<td>67</td>
<td>102811.940299</td>
<td>67</td>
<td>116431.746753</td>
<td>1386</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Unclassified Industry</td>
<td>57</td>
<td>129006.070175</td>
<td>57</td>
<td>113253.334609</td>
<td>9148</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Other Computer Related Services</td>
<td>53</td>
<td>117909.245283</td>
<td>53</td>
<td>118771.586707</td>
<td>1309</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Administrative Management and General Manageme...</td>
<td>52</td>
<td>156290.384615</td>
<td>52</td>
<td>133606.945132</td>
<td>4447</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>Offices of Certified Public Accountants</td>
<td>48</td>
<td>116174.354167</td>
<td>48</td>
<td>130229.120365</td>
<td>1645</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>Software Publishers</td>
<td>35</td>
<td>95534.285714</td>
<td>35</td>
<td>131028.541624</td>
<td>973</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>Commercial Banking</td>
<td>34</td>
<td>145390.588235</td>
<td>34</td>
<td>120671.148515</td>
<td>1919</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="ai-powered-roles-salaries-vs.-non-ai-roles-salaries" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> AI-powered Roles Salaries vs.&nbsp;Non-AI Roles Salaries</h1>
<div id="3a203649" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os, re</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> textwrap <span class="im">import</span> shorten</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.ticker <span class="im">import</span> FuncFormatter</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="st">"ai_vs_trad_industry_salary"</span> <span class="kw">in</span> <span class="bu">globals</span>(), <span class="st">"Run the prep chunk first."</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>dfp <span class="op">=</span> ai_vs_trad_industry_salary.copy()</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> dfp.empty:</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"No data to plot after filtering. Check AI detection or industry column."</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># shorten very long industry labels</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> short_label(s: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> <span class="bu">str</span>(s)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">services</span><span class="op">?</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Svcs'</span>, s)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">manufacturing</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Mfg'</span>, s)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">management</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Mgmt'</span>, s)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">computer</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Comp'</span>, s)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="fu">(?i)</span><span class="dv">\b</span><span class="vs">equipment</span><span class="dv">\b</span><span class="vs">'</span>, <span class="st">'Equip'</span>, s)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="dv">\s</span><span class="op">+</span><span class="vs">'</span>, <span class="st">' '</span>, s).strip()</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> shorten(s, width<span class="op">=</span><span class="dv">36</span>, placeholder<span class="op">=</span><span class="st">'â€¦'</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    dfp[<span class="st">"label"</span>] <span class="op">=</span> dfp[IND_COL].<span class="bu">map</span>(short_label)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(dfp))</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> <span class="fl">0.38</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">7</span>))</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    b1 <span class="op">=</span> ax.bar([i <span class="op">-</span> w<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> x], dfp[<span class="st">"avg_ai_salary"</span>],    width<span class="op">=</span>w, label<span class="op">=</span><span class="st">"AI job posts"</span>,     edgecolor<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    b2 <span class="op">=</span> ax.bar([i <span class="op">+</span> w<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> x], dfp[<span class="st">"avg_nonai_salary"</span>], width<span class="op">=</span>w, label<span class="op">=</span><span class="st">"Non-AI job posts"</span>, edgecolor<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">"Average Salary â€” AI vs. Non-AI Posts in Top AI Industries"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Industry (Top by AI Posting Volume)"</span>)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Average Salary ($)"</span>)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(<span class="bu">list</span>(x))</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(dfp[<span class="st">"label"</span>], rotation<span class="op">=</span><span class="dv">35</span>, ha<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_formatter(FuncFormatter(<span class="kw">lambda</span> v, pos: <span class="ss">f"$</span><span class="sc">{</span><span class="bu">int</span>(v)<span class="sc">:,}</span><span class="ss">"</span>))</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    ax.grid(axis<span class="op">=</span><span class="st">"y"</span>, alpha<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    ax.legend()</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># annotate bars</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> bars <span class="kw">in</span> (b1, b2):</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> p <span class="kw">in</span> bars:</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>            h <span class="op">=</span> p.get_height()</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> h <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>                ax.text(p.get_x()<span class="op">+</span>p.get_width()<span class="op">/</span><span class="dv">2</span>, h, <span class="ss">f"$</span><span class="sc">{</span><span class="bu">int</span>(h)<span class="sc">:,}</span><span class="ss">"</span>,</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>                        ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"bottom"</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    os.makedirs(<span class="st">"output"</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="st">"output/ai_vs_nonai_avg_salary_by_industry.png"</span>, dpi<span class="op">=</span><span class="dv">200</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/cell-11-output-1.png" width="1320" height="662" class="figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>